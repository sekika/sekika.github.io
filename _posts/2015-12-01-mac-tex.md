---
layout: post
title: Mac で TeX / LaTeX
date: 2015-12-01 06:42:07 +0000
update: 2017-05-13 18:43:07 +0000
tags:
- mac
- tex
---
`macOS` で `TeX` / `LaTeX` を使えるようにするための手順を記す。MacTeX はあえて使わずに、`TeX Live` を直接入れる。独自のディレクトリ構成にならないので便利。詳しくは参考サイト参照。

* [インストール](#install)
* [ヒラギノフォントの埋め込み設定](#font)
* [確認](#check)
* [メンテナンス](#maintenance)
* [参考サイト](#ref)

<a id="install"></a>
<a href="#install"></a> 

## インストール

- `/usr/local` ディレクトリが存在しない場合には、[あらかじめ作成しておく]({% post_url 2015-11-26-el-capitan-homebrew %})必要がある。 
- [TeX Live](http://www.tug.org/texlive/) から [install-tl-unx.tar.gz](http://mirror.ctan.org/systems/texlive/tlnet/install-tl-unx.tar.gz) をダウンロード、展開して `install-tl-yyyymmdd` ディレクトリ内で ```sudo ./install-tl``` を実行。
- TeX Live 2016 をインストールするときには、次のコマンドを実行して ```/usr/local/texlive/current``` で現在使用中の TeX Live の年次を指定できるようにする（2016のところは年次にあわせて変える）。年次をアップデートするときにも、同様のコマンドでリンクを更新する。

~~~
cd /usr/local/texlive; sudo ln -s 2016 current
~~~

- パスを通すために、```~/.bash_profile``` にこの行を追記。

~~~
export PATH=$PATH:/usr/local/texlive/current/bin/x86_64-darwin
~~~

- [tlmgr](http://www.fugenji.org/~thomas/texlive-guide/tlmgr.html) の設定

~~~
sudo tlmgr option repository http://mirror.ctan.org/systems/texlive/tlnet
~~~

-  [Homebrew](http://brew.sh/index_ja.html) で gs と poppler をインストール。poppler は [pdffonts](http://ototorosama.hatenablog.com/entry/2013/02/14/055355) を使えるようにするため。

~~~
brew install gs poppler
~~~

<a id="font"></a>
<a href="#font"></a> 

## ヒラギノフォントの埋め込み設定

[macOS のヒラギノフォントは商用利用可能](http://www.macotakara.jp/blog/support/entry-665.html)である。ヒラギノフォントの埋め込み設定について、macOS Sierra (10.12) と El Capitan (10.11) の場合は以下のようにする。

~~~
cd /usr/local/texlive/current/texmf-dist/scripts/cjk-gs-integrate
sudo perl cjk-gs-integrate.pl --link-texmf --force
sudo mktexlsr
sudo kanji-config-updmap-sys hiragino-elcapitan-pron
~~~

 [JIS X 0213](https://ja.wikipedia.org/wiki/JIS_X_0213)に対応したヒラギノの [N シリーズ](http://fontnavi.jp/zakkuri/205-N_fonts.aspx)を埋め込んでいる。[Yosemite 10.10 以前の場合はこちら](http://doratex.hatenablog.jp/entry/20160608/1465311609)。

<a id="check"></a>
<a href="#check"></a> 

## 確認

[サンプル TeX ファイル](https://gist.github.com/sekika/34cad1547e92a62a4a1b)のコンパイル、生成されたPDFファイルの確認とフォントのチェック。

~~~
curl -sO https://gist.githubusercontent.com/sekika/34cad1547e92a62a4a1b/raw/sample.tex
platex sample.tex
dvipdfmx sample.dvi
open sample.pdf &
pdffonts sample.pdf
~~~

* [このように](https://gist.github.com/sekika/e36726eed3a9a7c3b27d) ```emb``` の欄がすべて ```yes``` になっていれば、フォント埋め込みOK。
* 確認後、```rm sample.*```  でファイルを消せる。

<a id="maintenance"></a>
<a href="#maintenance"></a> 

## メンテナンス

パッケージの更新

~~~
sudo tlmgr update --self --all
~~~

TeX Live のバージョン（年次）のメジャーアップグレードについては、[TeX Live のページ](http://www.tug.org/texlive/upgrade.html)ではインストールを最初からやり直すことを勧める、としている。特に、2015から2016へアップグレードは、インフラが変わったので最初からやり直す必要がある。[インストール](#install)の2番目（install-tl-unx.tar.gz のダウンロード、展開と sudo ./install-tl）と3番目（current リンクの更新）を実行すれば良い。ただし、年次によっては勝手に新しい年次にアップデートされる場合もあるようだ。

ちなみに、私の場合は次のような ```update``` というスクリプトを書いて、TeX Live, Homebrew, pip のアップデートをまとめてしている。ここで、```pip-review``` の実行には ```pip install pip-review``` が必要。

~~~
#!/bin/sh
sudo tlmgr update --self --all
brew update
brew upgrade
pip-review --auto
~~~

<a id="ref"></a>
<a href="#ref"></a> 
 
## 参考サイト
- [TeX Live を使おう──Linux ユーザと Mac OS X ユーザのために──](http://fugenji.org/~thomas/texlive-guide/index.html) (Tamotsu Thomas UEDA, 2015)
- [TeX Wiki](http://oku.edu.mie-u.ac.jp/~okumura/texwiki/) (奥村晴彦) - [TeX Live/Mac](https://oku.edu.mie-u.ac.jp/~okumura/texwiki/?TeX%20Live%2FMac)
- [TeX界の El Capitan 迎撃戦記](http://doratex.hatenablog.jp/entry/20151008/1444310306) (TeX Alchemist Online, 2015/10/8)
- [MacTeX 2016 のインストール＆日本語環境構築法 (El Capitan 以前/以後両対応)](http://doratex.hatenablog.jp/entry/20160608/1465311609) (TeX Alchemist Online, 2016/6/8)
- [Sierra 時代の TeX Live 環境](http://doratex.hatenablog.jp/entry/20161202/1480665692) (TeX Alchemist Online, 2016/12/2)
