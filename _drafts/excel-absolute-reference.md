---
layout: post
title: "相対参照と絶対参照"
tag: excel
---
Excel の相対参照と絶対参照について、授業で使っている説明資料をこちらにコピーしておきます。

-  計算式でセルを参照する方式には、セルの位置を入力セルとの相対的な位置関係で指定する相対参照と、セルの位置を絶対的な位置で指定する絶対参照の二種類がある。
- セルの位置をアルファベットと数字で指定すると、相対参照になる。つまり、D5セルでB5と入力した場合には、B5という位置を絶対的に指定したのではなく、D5から左へ２つ移動したセルを相対的に指定したものと考える。したがって、数式をコピーすると参照セルも一緒に移動する。
- 参照セルを移動させずに固定したい場合は、絶対参照を用いる。
- 絶対参照は、参照セルの、固定させたい行または列の前に$を指定する。
- たとえば、B5というセルの指定方法には、以下の4パターンがある。

1. B5: B5セルを相対参照
2. $B$5: B5セルを絶対参照
3. B$5: B列を相対参照、5行を絶対参照
4. $B5: B列を絶対参照、5行を相対参照

ファンクションキーのF4で、相対参照と絶対参照（3パターン）を指定できる。たとえば、計算式で「=B5」と指定した状態で、F4キーを1回押すと$B$5に、もう1回押すとB$5に、と順番に変わる。

理屈だけでは分かりにくいので、実例で学習する。このような九九の表を作ってみる。

![九九の表](/img/20151023-99.png)

まずは、B1-J1, A2-A10のセルに数字を入力する。次に、B2のセルに、```=B$1*$A2``` と入力して、右に[オートフィル機能](https://www.google.co.jp/search?q=%E3%82%AA%E3%83%BC%E3%83%88%E3%83%95%E3%82%A3%E3%83%AB+excel)で連続コピーする。その後、B2からJ2を選択した状態で、10列目まで連続コピーすることで完成する。このとき、以下の表のような式が入力されている。

![計算式](/img/20151023-99-eq.png)

$がついている$1と$Aはコピーしても変化せず、$がついていないBと2はそれぞれの方向にコピーすることで変化することが分かる。このように、$をつけることによって絶対参照となり、つけないことで相対参照となる。
