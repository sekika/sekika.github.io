---
layout: post
title: 成績ファイル作成スクリプト
tag: python
---
東洋大学教員以外には役に立たない記事です。

東洋大学の成績登録システムでは、学籍番号を1行目、成績を2行目に入力したテキストファイルを登録することになっている。そのファイル形式は

- 文字コードは UTF-16
- 区切り文字は TAB
- それ以外の余計なスペース等の文字が入っているとダメ
- 改行コードは CR/LF

となっていて、融通が利かないので作成するのが大変である。そこで「採点登録支援ツール」なるものが作られて、成績登録作業が「簡単にできる」ようになったとされているが、個人的にはどうも使いにくく、そもそも Mac ではうまく動かなかったりする。この支援ツールを使わない方法としては

- Excel でデータをコピーしたあとに、テキストエディタに貼り付ける（TAB区切りテキストとして貼り付けられる）
- Excel から「UTF-16 Unicode テキスト」で保存する

といった方法があるが、余計な文字（スペース等）が入っていると、これもうまくいかないことがある。

というわけで、`Python 3` で成績登録ファイル作成スクリプト `seiseki.py` を書いた。

- [東洋大学教員用成績登録ファイル作成スクリプト](https://gist.github.com/sekika/20f65cb7e2eed1cd84d4)

使い方は

~~~
seiseki.py 入力ファイル名 出力ファイル名
~~~

とする。入力ファイルは成績のCSVファイルで、1行目は学籍番号（半角数字10桁）、2行目は成績（SABCDE* のいずれか１文字）。成績は「/」を「*」に自動的に変換する。
