---
layout: post
title: 成績ファイル作成スクリプト
tag: python
---
東洋大学教員以外には役に立たないエントリです。

東洋大学の成績登録システムでは、学籍番号を1行目、成績を2行目に入力したテキストファイルを登録することになっている。このファイルはかなり厳格で、

- 文字コードは UTF-16
- 区切り文字は TAB
- 余計なスペースが入っているとダメ
- 改行コードは CR/LF

となっていて、融通が利かない。「採点登録支援ツール」を使うと一連の成績登録作業が簡単にできる、ということになっているが、個人的にはどうも使いにくく、そもそも Mac ではうまく動かなかったりする。このツールを使わない方法としては

- Excel でデータをコピーしたあとに、テキストエディタに貼り付ける
- Excel から「UTF-16 Unicode テキスト」で保存する

といった方法があるが、余計な文字（スペース等）が入っていると、これもうまくいかないことがある。

というわけで、python3 でスクリプトを書いた。

- [東洋大学教員用成績登録ファイル作成スクリプト](https://gist.github.com/sekika/20f65cb7e2eed1cd84d4)

使い方は

~~~
seiseki.py 入力ファイル名 出力ファイル名
~~~

とする。「入力ファイル名」は成績のCSVファイルで、1行目は学籍番号（半角数字10桁）、2行目は成績（SABCDE* のいずれか１文字、/ は * に変換）。
